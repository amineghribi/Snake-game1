<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Snake Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
body {margin:0;background:#111;color:white;font-family:Arial;text-align:center;}
h1{margin:5px 0;}
#info{display:flex;justify-content:space-around;font-size:16px;}
canvas{background:#000;display:block;margin:10px auto;border:2px solid #0f0;}
.controls{margin-top:10px;}
button{width:80px;height:70px;margin:5px;font-size:30px;border-radius:10px;border:none;background:#0f0;color:#000;font-weight:bold;}
</style>
</head>
<body>

<h1>ğŸ Snake</h1>

<div id="info">
<div id="score">Score: 0</div>
<div id="high">High: 0</div>
</div>

<canvas id="game" width="300" height="300"></canvas>

<div class="controls">
<button onclick="startGame()">â–¶ï¸ Start</button>
<div style="margin-top:10px;">
<button onclick="setDir('left')">â¬…ï¸</button>
<button onclick="setDir('right')">â¡ï¸</button>
</div>
</div>

<audio id="eat" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
<audio id="over" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const box=15;
const rows=canvas.height/box;
const cols=canvas.width/box;

let snake=[], dir='right', food={}, game=null, score=0, speed=150, started=false;
let moved=false; // Ù…Ù‡Ù…: ÙŠØªØ­ÙƒÙ… ÙÙŠ Ø£ÙˆÙ„ Ø­Ø±ÙƒØ©
let high=localStorage.getItem("snakeHigh")||0;
document.getElementById("high").textContent="High: "+high;

function init(){
  snake=[{x:Math.floor(cols/2)*box,y:Math.floor(rows/2)*box}];
  dir='right';
  score=0; speed=150; started=true; moved=false;
  food=randomFood();
  updateScore();
}

function randomFood(){
  let pos;
  do{ pos={x:Math.floor(Math.random()*cols)*box,y:Math.floor(Math.random()*rows)*box};
  }while(snake.some(p=>p.x===pos.x&&p.y===pos.y));
  return pos;
}

function startGame(){
  clearInterval(game); init();
  game=setInterval(draw,speed);
  if(document.documentElement.requestFullscreen){document.documentElement.requestFullscreen().catch(()=>{});}
}

function updateScore(){
  document.getElementById("score").textContent="Score: "+score;
  if(score>high){high=score;localStorage.setItem("snakeHigh",high);document.getElementById("high").textContent="High: "+high;}
}

function setDir(newDir){
  if(newDir==="left"&&dir!=="right")dir="left";
  if(newDir==="right"&&dir!=="left")dir="right";
}

function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);

// Ø±Ø³Ù… Ø§Ù„Ø«Ø¹Ø¨Ø§Ù†
snake.forEach((p,i)=>{ctx.fillStyle=i===0?"lime":"green";ctx.fillRect(p.x,p.y,box,box);});

// Ø±Ø³Ù… Ø§Ù„Ø·Ø¹Ø§Ù…
ctx.fillStyle="red";
ctx.fillRect(food.x,food.y,box,box);

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙŠØ¯
let head={...snake[0]};
if(dir==="left")head.x-=box;
if(dir==="right")head.x+=box;

// Game Over Ø¨Ø¹Ø¯ Ø£ÙˆÙ„ Ø­Ø±ÙƒØ©
if(moved){
  if(head.x<0||head.x>=canvas.width||snake.some(p=>p.x===head.x&&p.y===head.y)){
    document.getElementById("over").play();
    clearInterval(game);
    started=false;
    alert("Game Over | Score: "+score);
    return;
  }
} else { moved=true; } // Ø£ÙˆÙ„ Ø­Ø±ÙƒØ© ØªØ¹Ø¯ÙŠ Ø¨Ø¯ÙˆÙ† Game Over

// Ø¥Ø°Ø§ Ø£ÙƒÙ„ Ø§Ù„Ø·Ø¹Ø§Ù…
if(head.x===food.x&&head.y===food.y){
  document.getElementById("eat").play();
  score++; updateScore();
  if(speed>60){speed-=8; clearInterval(game); game=setInterval(draw,speed);}
  food=randomFood();
} else { snake.pop(); }

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø¬Ø¯ÙŠØ¯
snake.unshift(head);
}
</script>
</body>
</html>
